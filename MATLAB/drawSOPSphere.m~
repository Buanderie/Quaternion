% script to draw a spheree demonstrating the concept of stereographic
% projection
fig = figure;
fig.Color = 'white';

% draw the sphere
sphere();
% now make it somewhat transparent...
alpha(0.3);
hold on;
% now plotting the equatorial plane
d = 1.5;
n = 10;
x = linspace(-d, d, n);
y = linspace(-d, d, n);
[X, Y] = meshgrid(x, y);
Z = zeros(size(X));
eq_plane_plot = surf(X, Y, Z); 
eq_plane_plot.FaceAlpha = 0.5;

% The plane coordinates
psi = [0.5, -0.5]';
% the spherical coordinates
q = [2 * psi ; 1 - norm(psi)^2] / (1 + norm(psi)^2);
psi = [psi; 0];
% the line
S = [0;0;-1];
ray_margin = .8;
r = S + (psi - S) / norm(psi- S) .* linspace(0, 2 / (1+norm(psi)^2) + ray_margin, 100);
ray_plot = plot3(r(1, :), r(2, :), r(3, :), 'Color', 'r', 'LineWidth', 2);

% The points (psi and q)
points = [psi'; q'; S'];
dwidth = 4;
marksize = 30;
dots_plot = plot3(points(:,1), points(:,2), points(:, 3), 'k.', 'lineWidth', dwidth, 'MarkerSize', marksize);
point_labels = ['Ïˆ', char(0), char(0), char(0); 'q', char(0), char(0), char(0); 'S', char(0), char(0), char(0);'r(t)']; 
keys = [psi'+[-0.1, 0, 0]; q'+[0.2, 0, 0]; S' + [0,0,-0.1]; r(:, end)'];
text(keys(:, 1), keys(:, 2), keys(:, 3), point_labels, 'HorizontalAlignment', 'right','FontSize',16, 'FontName', 'FixedWidth', 'FontAngle', 'italic')
